<!DOCTYPE html>
<html lang="es-ES" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>Visualizar Reparaciones</title>
	<style>
		body {
			background-color: #BAF4FA;
			color: #6889BC;
			font-family: Calibri, sans-serif;
			margin: 0;
			padding: 0;
		}

		.header {
			background-color: #7AF4FA;
			padding: 10px;
			text-align: center;
		}

		.container {
			margin: 20px;
			padding: 20px;
			background-color: #fff;
			border-radius: 5px;
			box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
		}

		.content-table {
			border-collapse: collapse;
			width: 100%;
		}

		.content-table th,
		.content-table td {
			border: 1px solid #dddddd;
			text-align: left;
			padding: 8px;
		}

		.content-table th {
			background-color: #f2f2f2;
		}
	</style>
</head>

<body>
<header class="header">
	<h1>Visualizar Reparaciones</h1>

	<a class="cta-button" href="/vehiculos">Volver a la Lista de vehículos</a>
	<nav>
		<!-- Puedes agregar enlaces de navegación si es necesario -->
	</nav>
</header>
<div class="container">
	<table class="content-table">
		<thead>
		<tr>
			<th>ID</th>
			<th>Fecha de Ingreso</th>
			<th>Monto Total</th>
			<th>Fecha de Salida</th>
			<th>Fecha de Retiro</th>
			<th>ID Vehículo</th>
		</tr>
		</thead><tbody>
	<!-- Iterate over the list of Reparacion entities -->
	<tr th:each="reparacion : ${reparaciones}">
			<td th:text="${reparacion.id}"></td>
            <td th:text="${reparacion.fechaHoraIngreso}"></td>
            <td th:int="${reparacion.montoTotal}"></td>
            <!-- Check if fechaSalida is not null -->
            <td th:if="${reparacion.fechaHoraSalida != null}" th:text="${reparacion.fechaHoraSalida}"></td>
            <!-- If fechaSalida is null, display nothing -->
            <td th:unless="${reparacion.fechaHoraSalida != null}"></td>
            <!-- Similarly handle other nullable fields -->
            <td th:if="${reparacion.fechaHoraRetiro != null}" th:text="${reparacion.fechaHoraRetiro}"></td>
            <td th:unless="${reparacion.fechaHoraRetiro != null}"></td>
            <!-- idVehiculo is non-nullable, no need for conditional check -->
            <td th:text="${reparacion.idVehiculo}"></td>

		<td><a th:href="@{'/reparaciones/' + ${reparacion.idVehiculo}}">Ver reparaciones del vehiculo</a></td>
		<td><a th:href="@{'/reparacion/' + ${reparacion.id}}">Ver reparacion especifica</a></td>
		<td>
			<form action="/reparacion/{id}/salida" method="post" id="salidaForm">
				<input type="hidden" name="id" th:value="${reparacion.id}">
				<button type="submit">Update Salida Date and Time</button>
			</form>
		</td>

		<td>
			<form action="/reparacion/{id}/retiro" method="post" id="retiroForm">
				<input type="hidden" name="id" th:value="${reparacion.id}">
				<button type="submit">Update Retiro Date and Time</button>
			</form>
		</td>



	</tr>
	</tbody>

	</table>
</div>
<br>
<hr>
</body>
</html>
<script>

	function submitForm(formId) {
		document.getElementById(formId).submit();
	}

	function updateReparacion(url) {
		fetch(url, {
			method: 'PUT'
		}).then(response => {
			if (response.ok) {
				// Refresh the page or handle success accordingly
				window.location.reload();
			} else {
				// Handle error response
				console.error('Failed to update reparacion');
			}
		}).catch(error => {
			console.error('Error:', error);
		});
	}
</script>